{# Accordion / FAQ Module #}

{% set section_classes = "accordion-section" %}
{% set section_classes = section_classes ~ " accordion--layout-" ~ module.style_group.layout %}
{% set section_classes = section_classes ~ " accordion--style-" ~ module.style_group.style %}
{% set section_classes = section_classes ~ " accordion--bg-" ~ module.style_group.background %}
{% set section_classes = section_classes ~ " accordion--padding-" ~ module.style_group.padding %}
{% set section_classes = section_classes ~ " accordion--icon-" ~ module.settings_group.icon_style %}

{% if module.style_group.background == "dark" %}
  {% set section_classes = section_classes ~ " accordion--text-light" %}
{% else %}
  {% set section_classes = section_classes ~ " accordion--text-dark" %}
{% endif %}

<section class="{{ section_classes }}">
  <div class="container">
    {# Section Header #}
    {% if module.header_group.show_header %}
      <div class="accordion__header">
        {% if module.header_group.badge %}
          <span class="accordion__badge">{{ module.header_group.badge }}</span>
        {% endif %}

        {% if module.header_group.heading %}
          <{{ module.header_group.heading_level }} class="accordion__heading">
            {{ module.header_group.heading }}
          </{{ module.header_group.heading_level }}>
        {% endif %}

        {% if module.header_group.subheading %}
          <p class="accordion__subheading">{{ module.header_group.subheading }}</p>
        {% endif %}
      </div>
    {% endif %}

    {# Accordion Items #}
    <div class="accordion__list"
      data-allow-multiple="{{ module.settings_group.allow_multiple|lower }}"
      data-first-open="{{ module.settings_group.first_open|lower }}"
    >
      {% for item in module.items %}
        {% set item_classes = "accordion__item" %}
        {% if module.settings_group.first_open and loop.first %}
          {% set item_classes = item_classes ~ " accordion__item--open" %}
        {% endif %}

        <div class="{{ item_classes }}">
          <button class="accordion__trigger" aria-expanded="{{ 'true' if (module.settings_group.first_open and loop.first) else 'false' }}">
            <span class="accordion__question">{{ item.question }}</span>

            {% if module.settings_group.icon_style != "none" %}
              <span class="accordion__icon" aria-hidden="true">
                {% if module.settings_group.icon_style == "plus" %}
                  <span class="accordion__icon-plus"></span>
                {% else %}
                  <svg class="accordion__icon-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                {% endif %}
              </span>
            {% endif %}
          </button>

          <div class="accordion__content" {% if not (module.settings_group.first_open and loop.first) %}hidden{% endif %}>
            <div class="accordion__answer">
              {{ item.answer }}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>
